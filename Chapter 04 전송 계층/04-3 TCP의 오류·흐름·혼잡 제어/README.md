# 04-3 TCP의 오류·흐름·혼잡 제어

## 📌 학습 목표
- 해당 챕터의 개념 정리

## ❓ 확인 문제

### Q1. TCP의 오류 제어, 흐름 제어, 혼잡 제어에 대한 설명 중 틀린 것은?

1️. 오류 제어는 데이터가 손실되거나 손상된 경우 재전송하는 메커니즘을 포함한다.

2️. 흐름 제어는 송신자가 수신자의 처리 속도에 맞춰 데이터 전송 속도를 조절하는 기능이다.

3️. 혼잡 제어는 송신자의 네트워크 상태를 고려하지 않고 항상 최대 속도로 데이터를 전송하도록 한다.

4. 혼잡 제어는 네트워크의 혼잡 상태를 감지하고 전송 속도를 조절하는 기능을 수행한다.

<details>
<summary>정답</summary>

- **3. 혼잡 제어는 송신자의 네트워크 상태를 고려하지 않고 항상 최대 속도로 데이터를 전송하도록 한다. X**   
  - TCP의 혼잡 제어는 네트워크의 혼잡 상태를 감지하고, 혼잡이 발생하면 전송 속도를 낮추는 방식으로 작동한다.

**[해설]**

- **1️. 오류 제어는 데이터가 손실되거나 손상된 경우 재전송하는 메커니즘을 포함한다. O**   
  -  TCP는 오류 제어 기능을 통해 데이터가 손실되거나 손상될 경우 재전송하는 기능을 제공합니다.


- **2. 흐름 제어는 송신자가 수신자의 처리 속도에 맞춰 데이터 전송 속도를 조절하는 기능이다. O**   
  - 흐름 제어는 송신자의 전송 속도를 조절하여 수신자가 처리할 수 있도록 도와줍니다.
  

- **4. 혼잡 제어는 네트워크의 혼잡 상태를 감지하고 전송 속도를 조절하는 기능을 수행한다. O** 
  - 혼잡 제어는 네트워크 상태를 고려하여 과부하를 방지하는 기능을 합니다.
  
---

</details> 

### Q2. TCP 재전송 기법에 대한 설명으로 틀린 것을 고르시오.

1. 대표적인 세 가지 방법으로 Stop-And-Wait, Go-Back-N, Selective Repeat이 있다.
2. Stop-And-Wait은 확인 응답을 받기 전까지, 새로운 메세지를 보내지 않는 방식이다.
3. Go-Back-N은 확인 응답을 받지 않더라도, 새로운 메세지를 보내는데, 도중에 잘못 전송된 세그먼트가 발생하면 해당 세그먼트만 다시 보내준다.
4. 오늘날 대부분의 호스트는 Selective Repeat ARQ를 지원한다.

<details>
<summary>정답</summary>

##### 3. Go-Back-N은 확인 응답을 받지 않더라도, 새로운 메세지를 보내는데, 도중에 잘못 전송된 세그먼트가 발생하면 해당 세그먼트만 다시 보내준다. -> X

**[해설]**
도중 잘못 전송된 세그먼트가 발생하면 해당 세그먼트만 다시 보내는 방법은 Selective Repeat ARQ이다.

Go-Back-N의 경우, 확인 응답을 받은 후, 손실된 세그먼트임이 판단되면, 해당 세그먼트 부터 다시 보낸다.

</details>

### Q3. 다음 중 TCP 흐름 제어에서 사용되는 슬라이딩 윈도우에 대한 설명으로 옳지 않은 것은?

#### 1. 슬라이딩 윈도우에서 윈도우는 송신 호스트가 파이프라이닝할 수 있는 최소량에 해당된다.

#### 2. 송신 호스트만 전송 시 윈도우를 고려하는 것이 아닌 수신 호스트 또한 윈도우를 고려한다.

#### 3. TCP 세그먼트 내에는 윈도우 필드가 존재하며, 수신 윈도우의 크기가 명시된다.

#### 4. 송수신 호스트에서 세그먼트 송수신 여부에 따라 윈도우를 움직여 TCP 흐름을 제어하는 기법이다.

<details>
<summary>정답</summary>

#### 1. 슬라이딩 윈도우에서 윈도우는 송신 호스트가 파이프라이닝할 수 있는 최소량에 해당된다.
- 윈도우는 송신 호스트가 확인 응답 없이 한번에 전송 가능한 최대량을 의미합니다.
- 송신 호스트는 수신 호스트가 알려주는 수신 측 윈도우를 토대로 세그먼트를 전송합니다.

---

</details>

### Q4. 다음 중 ARQ(Automatic Repeat reQuest) 기법에 대한 설명으로 올바른 것은?

#### 1️⃣ Stop-and-Wait ARQ는 한 번에 여러 개의 패킷을 전송하며, 수신자가 ACK를 보내기 전에 다음 패킷을 보낼 수 있다.
#### 2️⃣ Go-Back-N ARQ는 오류가 발생한 패킷만 재전송하는 방식으로, 불필요한 재전송을 최소화한다.
#### 3️⃣ Selective Repeat ARQ는 여러 개의 패킷을 연속으로 전송하며, 오류가 발생한 패킷만 선택적으로 재전송한다.
#### 4️⃣ ARQ 기법은 오류가 발생한 경우 송신자가 수신자의 확인 응답(ACK) 없이 무조건 패킷을 재전송하는 방식이다.

<details>
<summary>정답</summary>

#### 3️⃣ Selective Repeat ARQ는 여러 개의 패킷을 연속으로 전송하며, 오류가 발생한 패킷만 선택적으로 재전송한다.

**[해설]**

#### 1️⃣ Stop-and-Wait ARQ는 한 번에 하나의 패킷만 전송하고, ACK를 받아야 다음 패킷을 보낼 수 있음
#### 2️⃣ Go-Back-N ARQ는 오류가 발생하면 해당 패킷 이후 모든 패킷을 재전송
#### 4️⃣ ARQ 기법은 수신자의 응답(ACK)이나 NAK(재전송 요청)를 기반으로 재전송을 수행
---
#### ARQ(Automatic Repeat reQuest) 
- 데이터 전송 중 오류가 발생했을 때 수신자가 이를 감지하고 송신자에게 재전송을 요청하는 오류 제어 기법

  | 기법 | 전송 방식 | 오류 발생 시 동작 | 장점 | 단점 |
  | --- | --- | --- | --- | --- |
  | Stop-and-Wait ARQ | 한 번에 하나씩 전송 | Timeout 후 재전송 | 구현이 간단 | 속도가 느림 |
  | Go-Back-N ARQ | 여러 개 연속 전송 (N개) | 오류 발생 시 이후 모든 패킷 재전송 | Stop-and-Wait보다 빠름 | 불필요한 재전송 발생 |
  | Selective Repeat ARQ | 여러 개 연속 전송 (N개) | 오류 난 패킷만 재전송 | Go-Back-N보다 효율적 | 구현이 복잡 |
---

</details>


### Q5. TCP 혼잡 제어에서 사용하는 주요 알고리즘이 아닌 것은?

#### 1️⃣ Slow Start
#### 2️⃣ Congestion Avoidance
#### 3️⃣ Fast Recovery
#### 4️⃣ Sliding Window

<details>
<summary>정답</summary>

#### 4️⃣ Sliding Window (슬라이딩 윈도우): 슬라이딩 윈도우는 TCP 혼잡 제어가 아닌 **TCP 흐름 제어**에 관련된 개념

- TCP 혼잡 제어에서 사용하는 주요 알고리즘
    1. 느린시작(Slow Start)
    - 혼잡 윈도우를 1부터 시작해 문제없이 수신된 ACK 세그먼트 하나당 1씩 증가시키는 방식
    - 혼잡 윈도우를 지수적으로 증가시키므로 초기 전송 속도를 빠르게 확보할 수 있음
    2. 혼잡 회피(Congestion Avoidance)
    - RTT마다 혼잡 윈도우를 1 MSS(Maximum Segment Size) 씩 증가시켜 선형적으로 증가함
    - 느린 시작 임계치를 넘어선 시점부터 혼잡이 발생할 우려 있어 조심스럽게 혼잡 윈도우를 증가시키는 방식
    3. 빠른 회복 알고리즘(Fast Recovery)
    - 세 번의 중복 ACK 세그먼트를 수신했을 때 느린 시작은 건너뛰고 혼잡 회피 수행
    - 빠른 회복 도중이라도 타임 아웃이 발생하면 혼잡 윈도우 크기는 1로, 느린 시작 임계치는 혼잡이 감지된 시점의 절반으로 떨어뜨린 후 다시 느린 시작 수행
---

</details>


### Q6. 메시지를 전송한 뒤 그에 대한 답변을 받는 데까지 걸리는 시간은 무엇인가요?

<details>
<summary>정답</summary>

#### RTT(Round Trip Time): 송신 측에서 패킷을 전송한 후, 수신 측에서 응답(ACK)을 받아오기까지 걸리는 시간

- RTT는 네트워크의 성능을 나타내는 중요한 지표, RTT가 낮을수록 네트워크 응답 속도가 빠르고, 높을수록 지연이 발생
- RTT 측정 방법
    - ping 명령어 사용 : ping은 네트워크에서 특정 서버나 IP에 패킷을 보내고 응답 시간을 측정하는 명령어
    
---

</details>

---


### Q7. 한 네트워크에서 TCP 혼잡 제어가 적용되고 있다. 처음에는 혼잡 윈도우(cwnd) 크기가 1 MSS이다. 이후 송신자는 혼잡 제어 알고리즘을 적용하며, 다음과 같은 이벤트가 발생한다. 

```markdown
1. 느린 시작(Slow Start) 단계 : 3 RTT 동안 패킷 정상 전달 -> 이후 혼잡 회피 단계 진입
2. 혼잡 회피(Congestion Avoidance) 단계 : 추가 2 RTT 동안 패킷 정상 전달
3. 이후, 패킷 손실이 발생하여 빠른 회복(Fast Recovery) 수행
```
### 이 때, 각 단계 별 종료단계에서 **cwnd** 크기를 구하시오.

<details>
<summary>정답</summary>

#### 1. 느린 시작 단계 - cwnd : 8 MSS
#### 2. 혼잡 회피 단계 - cwnd : 10 MSS
#### 3. 빠른 회복 단계 - cwnd : 5 MSS

**[해설]**

### **1️⃣ 느린 시작 (Slow Start)**
- **RTT마다 cwnd 크기가 2배씩 증가**  
- 초기 `cwnd = 1 MSS`에서 시작하여 3 RTT 동안 증가:

| RTT | cwnd 크기 |
|----|----------|
| 1  | 2 MSS    |
| 2  | 4 MSS    |
| 3  | 8 MSS    |

✅ **3 RTT 후 `cwnd = 8 MSS`**

---

### **2️⃣ 혼잡 회피 (Congestion Avoidance)**
- **RTT마다 cwnd 크기가 1 MSS씩 증가**  
- 혼잡 회피 단계에서 **2 RTT 진행**:

| RTT | cwnd 크기 |
|----|----------|
| 4  | 9 MSS    |
| 5  | 10 MSS   |

✅ **5 RTT 후 `cwnd = 10 MSS`**

---

### **3️⃣ 빠른 회복 (Fast Recovery)**
- 패킷 손실이 발생하면 **cwnd 크기의 절반으로 감소**  
- 즉, **`cwnd = 10 MSS → 5 MSS`로 감소**

✅ **최종 `cwnd = 5 MSS`**

</details>

### **Q8. TCP 혼잡 제어 기법 중 적절한 사용 상황을 올바르게 연결한 것은?**  

#### 1️ **느린 시작** → 네트워크 혼잡이 발생했을 때 패킷 손실을 최소화하기 위해 사용된다.  
#### 2️ **혼잡 회피** → 네트워크 상태가 안정적일 때 과도한 데이터 전송을 방지하기 위해 사용된다.  
#### 3️ **빠른 회복** → TCP 연결이 처음 설정될 때 네트워크의 최적 전송 속도를 찾기 위해 사용된다.  
#### 4️ **느린 시작과 혼잡 회피는 항상 독립적으로 동작하며, 같은 연결에서는 함께 사용되지 않는다.**  

<details>  
<summary>정답</summary>  

#### **정답: 2️**  
- **혼잡 회피**는 네트워크가 안정적인 상태일 때 과도한 데이터 전송을 방지하는 기법으로, 송신 속도를 **선형적으로 증가**시키면서 네트워크의 혼잡을 예방한다.  
- **TCP**는 처음에는 **느린 시작** 기법을 적용하여 송신 속도를 **지수적으로 증가**시키지만, 특정 임계값(ssthresh)을 초과하면 **혼잡 회피** 기법으로 전환하여 서서히 증가시킨다.  

---  

- **1️ **느린 시작** → 네트워크 혼잡이 발생했을 때 패킷 손실을 최소화하기 위해 사용된다.**  
  - **TCP 연결 초기에** 네트워크의 처리 용량을 탐색하기 위해 송신 속도를 **지수적으로 증가**시키는 기법이다.  
  - 일정 임계값에 도달하면 **혼잡 회피** 단계로 전환된다.  

- **3️ **빠른 회복** → TCP 연결이 처음 설정될 때 네트워크의 최적 전송 속도를 찾기 위해 사용된다.**  
  - 패킷 손실이 발생했을 때, 송신 속도를 급격히 줄이지 않고 **서서히 회복**하는 기법이다.  
  - **TCP Reno** 방식에서는 **느린 시작**을 거치지 않고 바로 **혼잡 회피** 단계로 전환하여 전송 속도를 회복한다.  

- **4️ 느린 시작과 혼잡 회피가 함께 사용되지 않는다**  
  - **느린 시작**과 **혼잡 회피**는 독립적으로 동작하는 것이 아니라, 동일한 TCP 연결에서 **순차적으로 사용**된다.  
  - 송신 속도는 처음에는 **느린 시작**을 거쳐 증가하고, 특정 임계값에 도달하면 **혼잡 회피** 단계로 전환된다.  

</details>  


### **Q9. 오류 제어 기법 중 하나인 자동 재전송 요청(ARQ) 방식에는 여러 가지 기법이 존재합니다. 다음 재전송 기법의 특징을 설명하세요.**  

- **Stop-and-Wait ARQ**  
- **Go-Back-N ARQ**  
- **Selective Repeat ARQ**  

<details>  
<summary>정답</summary>  

### **기법의 특징**
| 재전송 기법 | 특징 | 사용 예시 |
|------------|------|----------|
| **Stop-and-Wait ARQ** | 패킷을 하나씩 전송하고, 응답(ACK)을 받기 전까지 대기 | 저속 무선 통신 (예: 위성 통신) |
| **Go-Back-N ARQ** | 여러 개의 패킷을 연속 전송하며, 오류 발생 시 해당 패킷 이후 모두 재전송 | 안정적인 네트워크 환경에서의 파일 전송 |
| **Selective Repeat ARQ** | 오류가 발생한 패킷만 선택적으로 재전송 | 고속 데이터 통신 (예: 영상 스트리밍, VoIP) |

---

### **Stop-and-Wait ARQ**
- **하나의 패킷을 전송한 후, 수신자로부터 ACK를 받을 때까지 대기**  
- 응답이 없으면 일정 시간이 지나면 패킷을 재전송  
- **장점:** 구현이 간단  
- **단점:** 네트워크 대역폭 활용도가 낮음  
-  **예시:** 무전기 통신이나 음성 메시지 송수신과 같이 "한 사람씩 말하는 방식"의 데이터 전송에 사용

---

### **Go-Back-N ARQ**
- **한 번에 여러 개의 패킷을 연속 전송**하며, 오류가 발생하면 **해당 패킷 이후의 모든 패킷을 재전송**  
- 송신자는 특정 개수(N)만큼의 패킷을 보낼 수 있고, 수신자가 ACK을 보낼 때까지 대기  
- **장점:** Stop-and-Wait보다 전송 속도가 빠름  
- **단점:** 불필요한 재전송이 많을 수 있음  
- **예시:** 이메일 전송 및 대용량 파일 다운로드와 같이 "순차적으로 패킷을 보내고 오류가 발생하면 이후 모든 데이터를 다시 받는 환경"에서 사용  

---

### **Selective Repeat ARQ**
- **오류가 발생한 패킷만 선택적으로 재전송**하는 방식  
- Go-Back-N과 유사하지만, 불필요한 패킷 재전송을 방지  
- **장점:** 불필요한 패킷 재전송을 줄여 효율성을 높임
- **단점:** 구현이 복잡  
- **예시:** 영상 스트리밍, VoIP(인터넷 전화)와 같은 실시간 데이터 전송 환경에서 활용  

---

### **체크섬**
- **체크섬도 오류 제어 기법의 한 종류**로, 오류를 감지하여 데이터의 무결성을 보장함
- 송신자는 데이터의 비트 값을 연산하여 체크섬 값을 생성하고, 이를 함께 전송한다.
- 수신자는 체크섬을 검증하여 데이터 오류 여부를 판단  
- 단순한 오류 검출 기능만 제공하며, 오류 수정 기능은 없음

---

</details>  

### Q10. 기존의 혼잡 제어 알고리즘은 송신 호스트의 연산에 의존해야 했다. 그러나 최근 라우터의 도움을 받는 방법이 생겼다. 이 방법은?


<details>
	<summary>정답</summary>
	<h4>ECN, 명시적 혼잡 알림</h4>
	---
	
	- 기존의 혼잡 제어 알고리즘과 달리 송신 호스트, 수신 호스트, 라우터 모두 ECN을 지원한다면 혼잡이 예상될 때 IP 헤더의 ECN 관련 필드에 혼잡 비트를 설정하여 수신 호스트에 전송
	- 이를 전달받은 수신 호스트는 송신 호스트에 TCP 세그먼트를 전송할 때 TCP 헤더의 ECN 관련 필드에 혼잡 비트를 활성화하여 전송
	- 중복된 ACK 신호 수신이나 타임아웃 등 문제 발생 후에 동작하던 기존의 혼잡 제어 알고리즘과 달리 문제 발생 이전에 대처할 수 있게 됨
</details>
## 📝 사용법  
### 이렇게 활용해 보세요! ✨  
1. ❓ 확인 문제 아래에 본인이 만든 질문을 추가하세요.  
2. 설명이 길어질 경우, 따로 마크다운 파일을 만들고 링크를 함께 추가해 주세요! 🔗  

### 🔗 링크 추가 방법  
1. 먼저 질문을 작성합니다.  
2. 링크를 적용할 문장을 마우스로 선택합니다.  
3. URL을 붙여넣습니다.  
4. 마크다운 형식으로 `[내용](링크)` 형태로 정리됩니다.  
