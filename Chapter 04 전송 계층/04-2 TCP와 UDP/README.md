# 04-2 TCP와 UDP

## 📌 학습 목표
- 해당 챕터의 개념 정리

## ❓ 확인 문제

### Q1. TCP와 UDP에 대한 설명 중 틀린 것은?

1️. TCP는 신뢰성 있는 데이터 전송을 보장하기 위해 연결 지향 방식을 사용한다.

2️. UDP는 TCP보다 전송 속도가 빠르며, 데이터 전송의 신뢰성을 보장하기 위한 흐름 제어를 제공한다.

3️. TCP는 패킷의 손실을 감지하면 재전송을 수행하여 데이터의 정확성을 보장한다.

4. UDP는 연결 설정이 필요 없는 비연결형 프로토콜이다.

<details>
<summary>정답</summary>

- **2. UDP는 TCP보다 전송 속도가 빠르며, 데이터 전송의 신뢰성을 보장하기 위한 흐름 제어를 제공한다. X**   
  - UDP는 빠른 데이터 전송이 가능하지만 흐름 제어나 오류 제어 기능이 없어 신뢰성을 보장하지 않습니다.

**[해설]**

- **1️. TCP는 신뢰성 있는 데이터 전송을 보장하기 위해 연결 지향 방식을 사용한다. O**   
  -  TCP는 연결을 설정한 후 데이터를 주고받는 연결 지향 프로토콜입니다.


- **3. TCP는 패킷의 손실을 감지하면 재전송을 수행하여 데이터의 정확성을 보장한다. O**   
  - TCP는 패킷이 손실될 경우 재전송을 수행하여 데이터의 정확성을 유지합니다.
  

- **4. UDP는 연결 설정이 필요 없는 비연결형 프로토콜이다. O** 
  - UDP는 비연결형 프로토콜로, 데이터 전송 전에 별도의 연결 설정 과정이 필요 없습니다.
  
---

</details> 

### Q2. TCP 세그먼트 구조에 대한 설명 중 틀린 것은?

1. 순서 번호 : 송수신되는 세그먼트의 올바른 순서를 보장하기 위해 세그먼트 데이터의 첫 바이트에 부여되는 번호이다. 
2. 확인 응답 번호 : 상대 호스트가 보낸 세그먼트에 대한 응답으로, 다음으로 수신을 바라는 세그먼트의 순서 번호이다.
3. 제어 비트 : 세그먼트에 대한 부가 정보를 나타내는 것으로, ACK, SYN, FIN이 자주 언급된다.
4. 윈도우 : 송신 윈도우의 크기가 명시된다. 한 번에 송신 가능한 데이터의 양을 나타낸다.

<details>
<summary>정답</summary>

- **4. 윈도우 : 송신 윈도우의 크기가 명시된다. 한 번에 송신 가능한 데이터의 양을 나타낸다.. X**   

**[해설]**

윈도우는, 엄밀히 말하면, 수신 윈도우의 크기이다. 수신 호스트에서 한 번에 수신가능한 데이터의 양을 나타낸 필드이다.
  
---

</details> 

### Q3. 다음 중 TCP 상태의 설명으로 옳지 않은 것은?

#### 1. SYN-SENT : 액티브 오픈 호스트가 SYN 세그먼트를 보낸 뒤 그에 대한 응답을 기다리는 상태.
#### 2. ESTABLISHED : TCP 통신을 위한 연결이 확립되었음을 나타내는 상태.
#### 3. LAST-ACK : FIN 세그먼트를 받은 패시브 클로즈 호스트가 그에 대한 응답으로 ACK 세그먼트를 보낸 후 대기하는 상태.
#### 4. TIME-WAIT : 액티브 클로즈 호스트가 FIN 세그먼트를 수신한 뒤, 이에 대한 ACK 세그먼트를 전송하고 접어드는 상태.

<details>
<summary>정답</summary>

#### 3. LAST-ACK : FIN 세그먼트를 받은 패시브 클로즈 호스트가 그에 대한 응답으로 ACK 세그먼트를 보낸 후 대기하는 상태.
- 해당 설명은 CLOSE-WAIT 상태를 의미합니다. 
- CLOSE-WAIT : 액티브 클로즈 호스트로부터 종료 요청인 FIN 세그먼트를 받은 패시브 클로즈 호스트가 그에 대한 응답으로 ACK 세그먼트를 보낸 후 대기하는 상태.
- LAST-ACK : CLOSE-WAIT 상태에서 FIN 세그먼트를 전송한 뒤 이에 대한 ACK 세그먼트를 기다리는 상태.

---

</details>

### Q4. 다음 중 UDP 데이터그램 구성 요소에 해당하지 않는 것은?

#### 1. 송신지 포트

#### 2. 수신지 포트

#### 3. 체크섬

#### 4. 순서 번호

<details>
<summary>정답</summary>

#### 4. 순서 번호
- 순서 번호는 TCP 세그먼트의 구성 요소입니다.
- 송신지 포트 : 송신지의 포트 번호가 명시되는 필드
- 수신지 포트 : 수신지의 포트 번호가 명시되는 필드
- 체크섬 : 데이터그램 전송 과정에서 오류가 발생했는지 검사하기 위한 필드
- 순서 번호 : 송수신되는 세그먼트의 올바른 순서를 보장하기 위해 세그먼트 데이터의 첫 바이트에 부여되는 번호

---

</details>

### Q5. TCP에서 3-Way Handshake와 4-Way Handshake의 과정과 각각의 목적을 설명하시오.

<details>
<summary>정답</summary>

1. **3-Way Handshake (TCP 연결 설정 과정)**

* 목적: 신뢰성 있는 연결 수립(Connection Establishment)
* 과정:<br>
  1️⃣ SYN (Client → Server): 연결 요청<br>
  2️⃣ SYN-ACK (Server → Client): 연결 요청 수락 및 응답<br>
  3️⃣ ACK (Client → Server): 연결 완료<br>

2. **4-Way Handshake (TCP 연결 해제 과정)**

* 목적: 안전한 연결 종료(Connection Termination)
* 과정:<br>
  1️⃣ FIN (Client → Server): 연결 종료 요청<br>
  2️⃣ ACK (Server → Client): 종료 요청 확인<br>
  3️⃣ FIN (Server → Client): 서버도 연결 종료 요청<br>
  4️⃣ ACK (Client → Server): 연결 해제 완료<br>
---

</details>


### Q6. 확인 응답 번호 값을 보내기 위해 제어 비트에서 승인을 나타내는 비트인 ACK 플래그를 몇으로 설정해야 하는가?

#### 1️⃣ 0
#### 2️⃣ 1
#### 3️⃣ 4
#### 4️⃣ 32

<details>
<summary>정답</summary>

#### 2️⃣ 1: 확인 응답 번호 값을 보내기 위해서는 제어 비트에서 승인을 나타내는 비트인 ACK 플래그 1로 설정
    
- 확인 응답 번호 값을 보내는 과정
    - 호스트가 순서 번호가 8000인 세그먼트를 수신하고, 다음으로 8001번 세그먼트를 받으려고 하면, 해당 호스트는 ACK 플래그를 1로 설정하고 확인 응답 번호로 8001을 명시한 세그먼트를 전송함.
    
---

</details>

### Q7. 다음은 TCP의 상태 변화를 나타낸 조직도이다. 빈칸에 들어갈 적절한 상태를 채우시오.
```markdown
연결 수립 과정 : [CLOSED] → (A) → [SYN-SENT] → (B) → [ESTABLISHED] → (C) → [FIN-WAIT-1]
연결 종료 과정 : (D) → [TIME-WAIT] → (E) → [CLOSED]
```

<details>
<summary>정답</summary>

#### (A) LISTEN
#### (B) SYN-RECEIVED
#### (C) CLOSE-WAIT
#### (D) FIN-WAIT-2
#### (E) CLOSED

**[해설]**
---
#### 📌 1️⃣ TCP 연결 수립 과정(3-Way Handshake)
#### 🔹(A) LISTEN
- **서버가 연결을 수락할 준비가 된 상태.**  
- 클라이언트의 연결 요청(**SYN**)을 기다림.

#### 🔹[SYN-SENT]
- **클라이언트가 서버에게 SYN 패킷을 보낸 후, 응답을 기다리는 상태.**  
- 이제 서버가 SYN을 받으면 응답을 보냄.

#### 🔹(B) SYN-RECEIVED
- **서버가 클라이언트의 SYN을 받고, SYN + ACK를 응답하는 상태.**  
- 클라이언트가 다시 **ACK**를 보내면 연결이 확립됨.

#### 🔹[ESTABLISHED]
- **TCP 연결이 완료되고, 양쪽이 데이터를 주고받을 수 있는 상태.**  
- 데이터 전송이 이루어지는 주요 상태.

---
#### 📌 2️⃣ TCP 연결 수립 과정(3-Way Handshake)
#### 🔹(C) CLOSE-WAIT
- **서버가 클라이언트의 FIN을 받고, 이를 확인(ACK)한 상태.**  
- 하지만 서버는 아직 데이터를 보낼 수도 있어서, 바로 닫지 않고 대기함.

#### 🔹[FIN-WAIT-1]
- **클라이언트가 FIN을 보내고, ACK를 기다리는 상태.**  
- 상대방도 FIN을 보내면 연결이 종료됨.

#### 🔹(D) FIN-WAIT-2
- **클라이언트가 서버로부터 FIN을 기다리는 상태.**  
- 상대방이 FIN을 보내면 응답(ACK)을 보낸 후 종료됨.

#### 🔹[TIME-WAIT]
- **클라이언트가 서버의 FIN을 받고, 마지막 ACK를 보낸 상태.**  
- 일정 시간 동안 대기한 후 종료됨. (재전송 타이머)

#### 🔹(E) CLOSED
- **모든 연결이 완전히 종료된 상태.**  

</details>

### **Q8. UDP가 적절한 경우는 언제인가요?**  

<details>  
<summary>정답 및 해설</summary>  

### **정답 및 해설**  

#### **정답**  
UDP는 **비연결형 프로토콜**로, 신뢰성을 보장하지 않지만 빠르고 가벼운 데이터 전송이 필요한 환경에서 널리 사용된다.  
> 온라인 게임, 실시간 스트리밍, 인터넷 전화, 주식 거래 시스템
---  

- **비연결형 프로토콜**  
  - 송·수신자 간의 연결 설정 없이 즉시 데이터 전송이 가능하며, 지연 시간이 줄어든다.  
  - 패킷 손실이 발생해도 재전송하지 않아 실시간성이 중요한 환경에서 유리하다.  

- **가벼운 헤더 구조와 낮은 오버헤드**  
  - UDP 헤더 크기는 8바이트로 작아 데이터 오버헤드가 적고 전송 효율이 높다.  
  - 네트워크 트래픽을 최소화하여 제한된 환경에서도 원활한 통신이 가능하다.  

- **패킷 손실을 감수할 수 있는 환경에서 유용**  
  - UDP는 오류 제어 및 재전송 기능이 없어 패킷 손실이 발생할 수 있지만, 실시간 데이터 전송에서는 손실보다 지연 없는 전송이 더 중요하므로 적합하다.
  - 오류 복구보다 속도가 중요한 스트리밍, 게임, 음성·영상 통신 등에 사용된다.  

- **멀티캐스트 및 브로드캐스트 지원**  
  - 하나의 송신자가 여러 수신자에게 동시에 데이터를 전송할 수 있다.  
  - 브로드캐스트는 네트워크 내 모든 기기에 데이터를 전송하며, ARP, DHCP에서 사용된다.
  - 멀티캐스트는 특정 그룹의 수신자에게 데이터를 전송하며, IPTV, 화상회의 등에 활용된다.  

---
- UDP는 **빠른 데이터 전송 속도, 낮은 오버헤드, 실시간성, 멀티캐스트 지원 등의 장점**을 갖고 있음
- 온라인 게임, 실시간 스트리밍, VoIP(인터넷 전화), 주식 거래 시스템 등 신뢰성보다 전송 속도가 중요한 환경에서 필수적인 프로토콜로 사용됨

</details>  

### Q9. TCP의 연결 종료 과정에서 액티브 클로징 호스트가 마지막 ACK 세그먼트를 보낸 후 바로 CLOSED 상태에 들어가지 않고 TIME-WAIT 상태에서 대기하는 이유는?

<details>
	<summary>정답</summary>
	<h4>패시브 클로징 호스트가 ACK 신호를 수신하지 못한 경우 재전송 해야하기 때문</h4>
	---
	
	- TCP의 4way-handshake는 총 4단계를 걸쳐 진행된다
		1. 액티브 클로징 호스트의 FIN 전송 (액티브: FIN-WAIT-1, 패시브: ESTABLISHED)
		2. 패시브 클로징 호스트의 ACK 전송 (액티브: FIN-WAIT-1, 패시브: CLOSE-WAIT)
		3. 패시브 클로징 호스트의 FIN 전송 (액티브: FIN-WAIT-2, 패시브: LAST-ACK)
		4. 액티브 클로징 호스트의 ACK 전송 (액티브: TIME-WAIT, 패시브: CLOSED)
	- 이 때, 패시브 클로징 호스트는 액티브 클로징 호스트의 ACK 신호를 받지 못한다면 LAST-ACK 상태에서 CLOSED 상태로 전환될 수 없고 액티브 클로징 호스트에 FIN 신호를 재전송한다
	- 이러한 비정상적인 종료 상황에 대비하여 FIN 신호가 재전송될 경우 이를 받아 ACK 신호를 재전송할 수 있도록 TIME-WAIT 상태로 대기하는 것이다.
</details>

## 📝 사용법  
### 이렇게 활용해 보세요! ✨  
1. ❓ 확인 문제 아래에 본인이 만든 질문을 추가하세요.  
2. 설명이 길어질 경우, 따로 마크다운 파일을 만들고 링크를 함께 추가해 주세요! 🔗  

### 🔗 링크 추가 방법  
1. 먼저 질문을 작성합니다.  
2. 링크를 적용할 문장을 마우스로 선택합니다.  
3. URL을 붙여넣습니다.  
4. 마크다운 형식으로 `[내용](링크)` 형태로 정리됩니다.  
