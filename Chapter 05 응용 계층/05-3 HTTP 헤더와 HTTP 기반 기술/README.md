# 05-3 HTTP 헤더와 HTTP 기반 기술

## 📌 학습 목표
- 해당 챕터의 개념 정리

## ❓ 확인 문제
### Q1. KKB씨는 미술 대회 신청을 해야하지만, 현재 다리를 다쳐 
### 신청을 위한 정보를 쿠키에 담아 원격으로 보내고자 한다.
### KKB씨가 쿠키에 담은 정보의 보안이 염려될 때 조치 할 수 있는 방법은?

#### 1️⃣ Secure 속성을 사용한다. 

#### 2️⃣ HttpOnly속성을 사용한다.

#### 3️⃣ 쿠키를 Base64로 인코딩한다.

#### 4️⃣ 쿠키 대신 세션 스토리지를 사용한다.

<details>
<summary>정답</summary>

#### 3️⃣ 쿠키를 Base64로 인코딩한다.

### 🔹 문제 분석
Base64 인코딩은 데이터를 변환할 뿐 암호화가 아님 

## 🔹 1️⃣ Secure 속성을 사용한다.  
✅ 
- `Secure` 속성을 설정하면 **쿠키가 HTTPS(보안 프로토콜)에서만 전송**됩니다.  
- 이를 통해 **네트워크에서 데이터가 평문으로 전송되는 것을 방지**할 수 있습니다.  
- HTTP 환경에서는 쿠키가 전송되지 않으므로, **중간자 공격(Man-in-the-Middle, MITM) 방지**에 효과적입니다.  

## 🔹 2️⃣ HttpOnly 속성을 사용한다.  
✅ 

- `HttpOnly` 속성을 사용하면 **자바스크립트에서 쿠키 접근이 불가능**합니다.  
- 이를 통해 **XSS(사이트 간 스크립트) 공격으로부터 보호**할 수 있습니다.  
- 공격자가 악성 스크립트를 실행하더라도 `document.cookie`를 통해 쿠키를 탈취할 수 없음. 

## 🔹 4️⃣ 쿠키 대신 세션 스토리지를 사용한다.  
✅   

- **세션 스토리지는 브라우저의 메모리에 저장되며, 브라우저를 닫으면 자동 삭제**됩니다.  
- **쿠키보다 보안이 강력하며, XSS 공격에도 비교적 안전**합니다.  
- 서버로 자동 전송되지 않으므로, **세션 토큰을 저장할 때 더 안전한 방법**이 될 수 있음.  

</details>

### Q2. 다음 중 HTTP 헤더와 기반 기술에 대한 설명으로 옳지 않은 것은 무엇인가요?

1️. HTTP 요청(Request) 헤더에는 User-Agent, Accept, Authorization과 같은 정보가 포함될 수 있다.

2️. HTTP 응답(Response) 헤더에는 Content-Type, Set-Cookie, Cache-Control 등의 정보가 포함될 수 있다.

3️. 쿠키(Cookie)는 클라이언트의 상태 정보를 저장하며, Set-Cookie 헤더를 통해 서버가 쿠키를 설정할 수 있다.

4. HTTP는 기본적으로 상태를 유지하는 프로토콜이므로, 별도의 기술 없이도 클라이언트와 서버 간 세션을 자동으로 유지할 수 있다.

<details>
<summary>정답</summary>

**4. HTTP는 기본적으로 상태를 유지하는 프로토콜이므로, 별도의 기술 없이도 클라이언트와 서버 간 세션을 자동으로 유지할 수 있다. X**   
  - HTTP는 기본적으로 상태를 유지하지 않는(stateless) 프로토콜이다.
  - 클라이언트와 서버 간 세션을 유지하려면 쿠키(Cookie), 세션(Session), 토큰(Token) 등의 기술을 추가적으로 사용해야 한다.
[해설]

**[해설]**

**1.HTTP 요청(Request) 헤더에는 User-Agent, Accept, Authorization과 같은 정보가 포함될 수 있다. O**   
  - User-Agent: 클라이언트의 브라우저 및 OS 정보 제공
  - Accept: 클라이언트가 받을 수 있는 콘텐츠 타입 명시
  - Authorization: 인증 정보 전달 (예: Bearer 토큰)


**2. HTTP 응답(Response) 헤더에는 Content-Type, Set-Cookie, Cache-Control 등의 정보가 포함될 수 있다. O**   
  - Content-Type: 응답의 콘텐츠 타입 (예: text/html, application/json)
  - Set-Cookie: 서버가 클라이언트에 쿠키를 설정하는 헤더
  - Cache-Control: 캐시 정책 지정 (예: no-cache, max-age=3600)
  

**3. 쿠키(Cookie)는 클라이언트의 상태 정보를 저장하며, Set-Cookie 헤더를 통해 서버가 쿠키를 설정할 수 있다. O** 
  - 쿠키는 세션 유지, 사용자 인증, 개인화 설정 등에 활용된다.
  
---

</details> 

### Q3. 쿠팡을 웹으로 들어가 로그인을 한 후, 쿠키를 지우고, 새로고침하면 로그인 상태가 해제된다 왜 이런 현상이 일어나는지 설명하시오.

<details>

<summary>정답</summary>

- 쿠키는 HTTP의 Stateless한 특성을 보완하기 위한 기술이다. 요청 처리 후, 서버는 응답헤더에 Set-Cookie헤더를 집어 넣어, 클라이언트의 브라우져내에 저장할 수 있도록 한다. 클라이언트가 같은 서버에 다시 요청을 날릴 때 Cookie헤더를 집어넣어 날리게 되고, 서버는 이를 보고 유저에 대한 상태를 파악할 수 있는 것이다. 세션이라던가, 기타 정보가 담긴 쿠키를 지워버렸으니, 클라이언트의 요청은 서버측에서 그냥 새로운 요청에 불과하고, 식별할 수 있는 정보가 아무것도 없으니, 로그아웃이 풀려버린 것이다.

</details>



### Q4. 다음 중 HTTP 기반 기술인 캐시에 대한 설명으로 옳지 않은 것은?

#### 1. 응답받은 내용의 사본을 임시로 저장하여 전송 시 대역폭 낭비와 응답 지연을 방지하는 기술이다.

#### 2. 사본이 저장되는 위치에 따라, 크게 개인 전용 캐시와 공용 캐시로 구분 가능하다.

#### 3. 캐시된 사본 데이터가 최신 원본 데이터와 유사한지를 검사하기 위해 날짜 혹은 엔티티 태그를 기반으로 서버에게 요청할 수 있다.

#### 4. 서버에 캐시 신선도 검사를 요청받은 자원이 변경되었을 경우, 서버는 상태 코드 304와 함께 새로운 자원을 반환한다.

<details>
<summary>정답</summary>

#### 4. 서버에 캐시 신선도 검사를 요청받은 자원이 변경되었을 경우, 서버는 상태 코드 304와 함께 새로운 자원을 반환한다.

- 서버에 캐시 신선도 검사를 요청받은 자원이 변경되었을 경우, 서버가 자원과 함께 반환하는 상태 코드는 200입니다.
- 상태 코드 304는 요청받은 자원이 변경되지 않았을 경우 반환됩니다. 이 경우 캐시된 자원을 문제없이 참조하여 사용할 수 있습니다.
- 서버는 상태 코드 304와 함께 Last-Modified 헤더를 반환하여 요청받은 자원이 마지막으로 수정된 시점도 클라이언트에게 알려 줄 수 있습니다.

</details>




### **Q5. CRUD 기능을 제공하는 게시판에서 쿠키, 세션, 캐시를 활용할 데이터와 생성 주기는 어떻게 설계해야 할까?**  

<details>  
<summary>정답 및 해설</summary>  

### **쿠키**  
| 데이터 | 생성 시점 | 만료 및 갱신 |
|------------|----------|--------------|
| 사용자 인증 정보 (세션 ID) | 로그인 시 | 세션 만료 또는 일정 기간 유지 (7~30일) |
| 사용자 환경 설정 (다크 모드, 언어 등) | 설정 변경 시 | 변경 시 갱신 |
| 자동 로그인 정보 (토큰) | 자동 로그인 선택 시 | 설정된 만료 기간까지 유지 (30일) |
| 최근 방문한 페이지 | 특정 페이지 방문 시 | 일정 기간(1주일) 후 삭제 |

- **클라이언트에서 관리되므로 보안이 필요한 데이터는 저장하지 않으며, Secure, HttpOnly 속성을 적용해야 함.**  

---

### **세션**  
| 데이터 | 생성 시점 | 만료 및 갱신 |
|------------|----------|--------------|
| 사용자 로그인 정보 | 로그인 시 | 브라우저 종료 시 삭제 (설정 가능) |
| 임시 작성 중인 게시글 | 글 작성 중 | 일정 시간(30분) 유지, 제출 시 삭제 |
| 관리자 인증 정보 | 관리자 로그인 시 | 로그아웃 시 삭제 또는 일정 시간 후 만료 |

- **서버에서 관리되므로 메모리 사용을 고려해 일정 시간 후 자동 만료되도록 설정해야 함.**  

---

### **캐시**  
| 데이터 | 생성 시점 | 만료 및 갱신 |
|------------|----------|--------------|
| 인기 게시글 목록 | 조회 수 증가 시 | 일정 시간 후 갱신 |
| 게시글 상세 내용 | 동일한 요청 반복 시 | 일정 시간 유지 후 갱신 |
| 검색 결과 | 동일한 검색 요청 반복 시 | 일정 시간 후 삭제 |
| 자주 호출되는 API 응답 | 다수의 요청 발생 시 | 일정 시간 유지 |

- **캐시 만료 시간은 데이터 특성과 서비스 요구 사항에 따라 적절히 조정해야 함.**  
- **자주 변경되는 데이터(댓글, 실시간 정보)는 캐시 유지 시간을 짧게 설정하여 최신성을 유지해야 함.**  

---

### **고려 사항**  
- **쿠키, 세션, 캐시는 서비스 성능을 향상시키지만, 과도하게 사용하면 오히려 속도 저하를 초래할 수 있음.**  
- **각 기능의 목적과 데이터 특성을 고려하여 적절한 만료 시간과 저장 방식을 설정해야 함.**  
- **불필요한 데이터가 과도하게 쌓이지 않도록 관리하고, 자주 변경되는 데이터는 캐싱 주기를 짧게 설정하는 것이 중요함.**  

</details>  

### Q6. 다음 중 HTTP 헤더에 대한 설명으로 올바른 것은?
#### 1️⃣ User-Agent 헤더는 클라이언트의 브라우저 또는 애플리케이션 정보를 서버에 전달하는 역할을 한다.
#### 2️⃣ Content-Type: text/html은 응답 본문의 인코딩 방식을 정의한다.
#### 3️⃣ Set-Cookie 헤더는 캐시 관련 설정을 관리하는 용도로 사용된다.
#### 4️⃣ Accept-Language는 클라이언트의 IP 주소를 포함하는 헤더이다.

<details> 
<summary>정답</summary>

#### 1️⃣ User-Agent 헤더는 클라이언트의 브라우저 또는 애플리케이션 정보를 서버에 전달하는 역할을 한다.

**[해설]**

#### **2️⃣ `Content-Type` (오답)**
- `Content-Type` 헤더는 **응답 본문의 MIME 타입**을 정의하는 역할을 하며 **인코딩 방식(예: UTF-8 등)을 정의하는 헤더가 아님.**

#### **3️⃣ `Set-Cookie` (오답)**
- `Set-Cookie` 헤더는 **클라이언트에 쿠키를 저장**할 때 사용되며 **캐시 관련 설정을 관리하는 용도로 사용되지 않음.**

#### **4️⃣ `Accept-Language` (오답)**
- `Accept-Language` 헤더는 **클라이언트가 선호하는 언어를 서버에 전달**하는 역할을 하며 **IP 주소를 포함하는 헤더가 아님.**

</details>

## 📝 사용법  
### 이렇게 활용해 보세요! ✨  
1. ❓ 확인 문제 아래에 본인이 만든 질문을 추가하세요.  
2. 설명이 길어질 경우, 따로 마크다운 파일을 만들고 링크를 함께 추가해 주세요! 🔗  

### 🔗 링크 추가 방법  
1. 먼저 질문을 작성합니다.  
2. 링크를 적용할 문장을 마우스로 선택합니다.  
3. URL을 붙여넣습니다.  
4. 마크다운 형식으로 `[내용](링크)` 형태로 정리됩니다.  
